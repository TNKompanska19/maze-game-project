#include<iostream>
#include<iomanip>
#include<conio.h>

using namespace std;

#define KEY_UP 72
#define KEY_DOWN 80
#define KEY_LEFT 75
#define KEY_RIGHT 77
#define ENTER 13

void menu(int counter) {
    std::cout << "\033[1;31m";
    std::cout << "\n \n \n";
    std::cout << "              /////////////////  ///       ///  ////////////     /////          /////  ///////////  ////  /////////////  ////////////     /////////////  ///       ///  //////     ///  //////     ///  ////////////  ///////////// \n";
    std::cout << "                    ///         ///       ///  ///              /// ///      /// ///  ///     ///  ////            ///  ///              ///       ///  ///       ///  /// ///    ///  /// ///    ///  ///           ///       ///  \n";
    std::cout << "                   ///         ///       ///  ///              ///  ///    ///  ///  ///     ///  ////          ///    ///              ///       ///  ///       ///  ///  ///   ///  ///  ///   ///  ///           ///       ///   \n";
    std::cout << "                  ///         /////////////  ///////////      ///   ///  ///   ///  ///////////  ////        ///      ////////////     ///////////    ///       ///  ///   ///  ///  ///   ///  ///  ////////////  ///////////       \n";
    std::cout << "                 ///         ///       ///  ///              ///    //////    ///  ///     ///  ////      ///        ///              ///      ///   ///       ///  ///    /// ///  ///    /// ///  ///           ///      ///      \n";
    std::cout << "                ///         ///       ///  ///              ///              ///  ///     ///  ////    ///          ///              ///      ///   ///       ///  ///     //////  ///     //////  ///           ///      ///       \n";
    std::cout << "               ///         ///       ///  ////////////     ///              ///  ///     ///  ////   ////////////  ////////////     ///      ///   /////////////  ///      /////  ///      /////  ////////////  ///      ///        \n\n\n";
    std::cout << std::setw(186) << " __________________________________________________________________________________________________________________________________\n";
    std::cout << "                                                      |  |     *       *       *       *       *       *       *       *       *       *   _________________    *       *     *       |  |\n";
    std::cout << "                                                      |  |* *     * *     * *     * *     * *     * *     * *     * *     * *     * *     |  _____________  |      * *     *     * *  |  |\n";
    std::cout << "                                                      |  |     *       *       *       *       *       *       *     __________        *  | |  *       *  | |_________________________|  |\n";
    std::cout << "                                                      |  |________     *       *       *       *       *       *    |  ______  |       *  | |  *       *  |  _________________________   |\n";
    std::cout << "                                                      |   ________| *      *  _______________ * *   ___________  * *| |      | |__________| |     * *     | | *      * *     * *     *|  |\n";
    std::cout << "          \\\\\\\\\\\\\          ||||||          ///////     |  |   *  | |    *     |  ___________  |     |  ______   |____| |   *  |______________|  *       *  | |     *       *       *   |  |\n";
    std::cout << "           \\\\\\\\\\\\\         ||||||         ///////      |  |*   * | |    *     | |  *        | |_____| |      |_________|   *       *       *    *       *  | | *      * *     * *     *|  |                                             ////\n";
    std::cout << "            \\\\\\\\\\\\\        ||||||        ///////       |  |*   * | |__________| |     *  *  |_________| *     * *     * *     * *     * *          * *     | |_________    *       *   |  |                                            ////\n";
    std::cout << "             \\\\\\\\\\\\\       ||||||       ///////        |  | *    |______________|  *        * _____________________________________________________     *  |_________  |   *       *   |  |                           ////////        ////\n";
    std::cout << "              \\\\\\\\\\\\\      ||||||      ///////         |  |   *     *      *       *        *|                                                     |    *       *    | |*     * *     *|  |                         ///////////      ////\n";
    std::cout << "               \\\\\\\\\\\\\     ||||||     ///////          |  |______________________     *  *   |      C  H  O  O  S  E   A N   O  P  T  I  O  N      | *     * *     * | |   *       *   |  |                        ///////////      ////\n";
    std::cout << "                \\\\\\\\\\\\\    ||||||    ///////           |   ____________________  | *        *|                                                     |    *       *    | |   *       *   |  |                         ////////       ////\n";
    if (counter == 1) {

        std::cout << "                 \\\\\\\\\\\\\   ||||||   ///////            |  |      *       *     | | *        *|                                                     |    *       *    | |_______________|  |                          ////         ////\n";
        std::cout << "                  \\\\\\\\\\\\\  ||||||  ///////             |  | * *     * *     * *| |    *  *   |   --------       P L A Y  G A M E   --------        | *     * *     * |_________________   |              ////////////////////////////\n";
        std::cout << "                   \\\\\\\\\\\\\ |||||| ///////              |  |      *       *     | | *        *|                                                     |    *       *       *        *     |  |             ////    //////////// \n";
        std::cout << "                    \\\\\\\\\\\\\||||||///////               |  |      *       *     | | *        *|                                                     |    *       *       *        *     |  |            ////    ////////////\n";
        std::cout << "       ||||||||||||||||||||||||||||||||||||||||||||   |  | * *     * *     * *| |    *  *   |                H O W  T O  P L A Y                  |_________________       * *     * *|  |           ////    ////////////\n";
        std::cout << "       ||||||||||||||||||||||||||||||||||||||||||||   |  |      *       *     | |    *  *   |                                                     |_______________  |   *       *     |  |          ////    ////////////\n";
        std::cout << "                    //////||||||\\\\\\\\\\\\\                |  |      *       *     | |___________|                                                     |    *       *  | |   *       *     |  |         ////    ////////////\n";
        std::cout << "                   ////// |||||| \\\\\\\\\\\\\               |  | * *     * *     * *|_____________|                      E X I T                        | *     * *     | |*     * *     * *|  |        ////    ////////////\n";
        std::cout << "                  //////  ||||||  \\\\\\\\\\\\\              |  |      *       *       *      *    |                                                     |     __________| |_________________|  |       ////   //////////////    \n";
        std::cout << "                 //////   ||||||   \\\\\\\\\\\\\             |  |      *       *       *      *    |_____________________________________________________|    |  ____________________________   |             //////   \\\\\\\\\\\\\n";

    }
    else if (counter == 2) {
        std::cout << "                 \\\\\\\\\\\\\   ||||||   ///////            |  |      *       *     | | *        *|                                                     |    *       *    | |_______________|  |                          ////         ////\n";
        std::cout << "                  \\\\\\\\\\\\\  ||||||  ///////             |  | * *     * *     * *| |    *  *   |                  P L A Y  G A M E                   | *     * *     * |_________________   |              ////////////////////////////\n";
        std::cout << "                   \\\\\\\\\\\\\ |||||| ///////              |  |      *       *     | | *        *|                                                     |    *       *       *        *     |  |             ////    //////////// \n";
        std::cout << "                    \\\\\\\\\\\\\||||||///////               |  |      *       *     | | *        *|                                                     |    *       *       *        *     |  |            ////    ////////////\n";
        std::cout << "       ||||||||||||||||||||||||||||||||||||||||||||   |  | * *     * *     * *| |    *  *   |   --------     H O W  T O  P L A Y  --------        |_________________       * *     * *|  |           ////    ////////////\n";
        std::cout << "       ||||||||||||||||||||||||||||||||||||||||||||   |  |      *       *     | |    *  *   |                                                     |_______________  |   *       *     |  |          ////    ////////////\n";
        std::cout << "                    //////||||||\\\\\\\\\\\\\                |  |      *       *     | |___________|                                                     |    *       *  | |   *       *     |  |         ////    ////////////\n";
        std::cout << "                   ////// |||||| \\\\\\\\\\\\\               |  | * *     * *     * *|_____________|                      E X I T                        | *     * *     | |*     * *     * *|  |        ////    ////////////\n";
        std::cout << "                  //////  ||||||  \\\\\\\\\\\\\              |  |      *       *       *      *    |                                                     |     __________| |_________________|  |       ////   //////////////    \n";
        std::cout << "                 //////   ||||||   \\\\\\\\\\\\\             |  |      *       *       *      *    |_____________________________________________________|    |  ____________________________   |             //////   \\\\\\\\\\\\\n";
    }
    else if (counter == 3) {
        std::cout << "                 \\\\\\\\\\\\\   ||||||   ///////            |  |      *       *     | | *        *|                                                     |    *       *    | |_______________|  |                          ////         ////\n";
        std::cout << "                  \\\\\\\\\\\\\  ||||||  ///////             |  | * *     * *     * *| |    *  *   |                  P L A Y  G A M E                   | *     * *     * |_________________   |              ////////////////////////////\n";
        std::cout << "                   \\\\\\\\\\\\\ |||||| ///////              |  |      *       *     | | *        *|                                                     |    *       *       *        *     |  |             ////    //////////// \n";
        std::cout << "                    \\\\\\\\\\\\\||||||///////               |  |      *       *     | | *        *|                                                     |    *       *       *        *     |  |            ////    ////////////\n";
        std::cout << "       ||||||||||||||||||||||||||||||||||||||||||||   |  | * *     * *     * *| |    *  *   |                H O W  T O  P L A Y                  |_________________       * *     * *|  |           ////    ////////////\n";
        std::cout << "       ||||||||||||||||||||||||||||||||||||||||||||   |  |      *       *     | |    *  *   |                                                     |_______________  |   *       *     |  |          ////    ////////////\n";
        std::cout << "                    //////||||||\\\\\\\\\\\\\                |  |      *       *     | |___________|                                                     |    *       *  | |   *       *     |  |         ////    ////////////\n";
        std::cout << "                   ////// |||||| \\\\\\\\\\\\\               |  | * *     * *     * *|_____________|   --------           E X I T        --------        | *     * *     | |*     * *     * *|  |        ////    ////////////\n";
        std::cout << "                  //////  ||||||  \\\\\\\\\\\\\              |  |      *       *       *      *    |                                                     |     __________| |_________________|  |       ////   //////////////    \n";
        std::cout << "                 //////   ||||||   \\\\\\\\\\\\\             |  |      *       *       *      *    |_____________________________________________________|    |  ____________________________   |             //////   \\\\\\\\\\\\\n";
    }
    std::cout << "                //////    ||||||    \\\\\\\\\\\\\            |  | * *     * *     * *     * *     * *     * *     * *     * *     * *     * *| |             *| |  * *     * *     * *    * *|  |            //////     \\\\\\\\\\\\\n";
    std::cout << "               //////     ||||||     \\\\\\\\\\\\\           |  |_____________         *       *       * ____________  *       *       ______| |              | |                            |  |           //////       \\\\\\\\\\\\\n";
    std::cout << "              //////      ||||||      \\\\\\\\\\\\\          |   ___________  |        *       *       *|  ________  | *       *      |  ______|     *       *| |     *       *       *      |  |          //////         \\\\\\\\\\\\\n";
    std::cout << "             //////       ||||||       \\\\\\\\\\\\\         |  | * *     * | |   * *     * *     * *   | |  * *   | |________________| | *     * *     * *   | | * *     * *     * *     * *|  |         //////          //////\n";
    std::cout << "            //////        ||||||        \\\\\\\\\\\\\        |  |      *    | |*       *       *        | |       *|____________________|       *       *     | | *       *       *       *  |  |        //////          ////// \n";
    std::cout << "           //////         ||||||         \\\\\\\\\\\\\       |  |      *    | |_________________________| |___________________________________________________| |    *       *       *       |  |       //////          //////\n";
    std::cout << "          //////          ||||||          \\\\\\\\\\\\\      |  | * *     * |___________________________________________________________________________________|     * *     * *            |  |      //////          //////\n";
    std::cout << "         //////           ||||||           \\\\\\\\\\\\\     |__________________________________________________________________________________________________________________________________|     //////          //////\n";


}

void resetMaze(char* maze[], int width, int height, char wall) {
    for (int i = 0; i < width; i++) {
        for (int j = 0; j < height; j++) {
            maze[i][j] = wall;
        }
    }
}

int isInPath(int x, int y, int width, int height) {
    if (x >= 0 && x < width && y >= 0 && y < height) return true;
    return false;
}

void checkIfPossibleMove(int x, int y, char* maze[], int width, int height, char wall) {
    maze[x][y] = ' ';

    int direction[4] = { 0, 1, 2, 3 };

    for (int i = 0; i < 4; ++i) {
        int r = rand() & 3;
        int temp = direction[r];
        direction[r] = direction[i];
        direction[i] = temp;
    }

    for (int i = 0; i < 4; ++i) {
        int nextX = 0, nextY = 0;

        switch (direction[i]) {
        case 0: nextY = -1; break;
        case 1: nextX = 1; break;
        case 2: nextY = 1; break;
        case 3: nextX = -1; break;
        }

        int x2 = x + (nextX * 2);
        int y2 = y + (nextY * 2);

        if (isInPath(x2, y2, width, height)) {
            if (maze[x2][y2] == wall) {
                maze[x2 - nextX][y2 - nextY] = ' ';
                checkIfPossibleMove(x2, y2, maze, width, height, wall);
            }
        }
    }
    maze[1][0] = ' ';
    maze[width - 2][height - 1] = ' ';
}

void generateMaze(char* maze[], int width, int height, char wall) {
    srand(time(0));
    resetMaze(maze, width, height, wall);
    checkIfPossibleMove(1, 1, maze, width, height, wall);
}

bool runGame(char player, char trace, char wall, int height, int width) {
    system("cls");

    int yPos = 1, xPos = 0;

    char** maze = new char* [height];
    for (int i = 0; i < height; i++) maze[i] = new char[width];

    generateMaze(maze, height, width, wall);

    maze[1][0] = player;

    for (int i = 0; i < height; i++) {
        for (int j = 0; j < width; j++) {
            std::cout << maze[i][j] << " ";
        }
        std::cout << std::endl;
    }

    while (yPos != height - 2 || xPos != width - 1) {
        char ch = _getch();

        switch ((int)ch) {
        case 72: {
            if (yPos != 0 && maze[yPos - 1][xPos] != wall) {
                maze[yPos][xPos] = trace;
                maze[--yPos][xPos] = player;
            }
        } break;
        case 75: {
            if (xPos != 0 && maze[yPos][xPos - 1] != wall) {
                maze[yPos][xPos] = trace;
                maze[yPos][--xPos] = player;
            }
        } break;
        case 77: {
            if (xPos != width - 1 && maze[yPos][xPos + 1] != wall) {
                maze[yPos][xPos] = trace;
                maze[yPos][++xPos] = player;
            }
        } break;
        case 80: {
            if (yPos != height - 1 && maze[yPos + 1][xPos] != wall) {
                maze[yPos][xPos] = trace;
                maze[++yPos][xPos] = player;
            }
        } break;
        }

        system("cls");

        for (int i = 0; i < height; i++) {
            for (int j = 0; j < width; j++) {
                std::cout << maze[i][j] << " ";
            }
            std::cout << std::endl;
        }
    }

    for (int i = 0; i < height; i++) {
        delete[] maze[i];
    }

    return 0;
}

bool menuInput() {
    int choice;
    int counter = 1;

    menu(counter);

    while (true)
    {
        switch ((choice = _getch())) {
        case KEY_UP:
        {
            if (counter == 1) counter = 4;
            counter--;
            system("CLS");
            menu(counter);
        }// key up
        break;
        case KEY_DOWN:
        {
            if (counter == 3)  counter = 0;
            counter++;
            system("CLS");
            menu(counter);
        }// key down
        break;
        case ENTER: {
            if (counter == 1) {
                char player = '?';
                char trace = '.';
                char wall = '#';

                int height = 15, width = 15;
                while (runGame(player, trace, wall, height, width)) {
                    runGame(player, trace, wall, height, width);
                }
                menuInput();
            }
        }
                  break;
        }// enter
    }
}
int main()
{
    do {
        menuInput();
    } while (menuInput());
}